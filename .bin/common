#!/bin/bash
USER_TMP=$HOME/.tmp
USER_CRYPT=$USER_TMP/crypt.img
SYNCED_PATH="$HOME/.synced/"
SSH_SYNC_PATH=${SYNCED_PATH}ssh/
PROFILE_DEF="${USER_TMP}/profile.next"
TOUCHPAD_SETTING="/tmp/touchpad"
READY="ready"
IS_CONNECTED=1
NOT_CONNECTED=0
PROXY_PORT=60000
DISPLAY_UN=/tmp/display-unlocked
DISPLAY_EN=/tmp/display-enabled
WORKPLACE_WORKING=/tmp/working
CRYPT_MNT=/mnt/crypt
SSH_KEY_PATH=${CRYPT_MNT}/ssh/

function toggle-touchpad()
{
    INPUT_ID=$(xinput | grep "ImPS/2" | sed -n -e 's/^.*id=//p' | sed -e "s/\s/ /g" | cut -d " " -f 1)
    IS_ENABLED=$(xinput list-props $INPUT_ID | grep "Device Enabled" | cut -d ":" -f 2)
    IS_ENABLED=$(echo $IS_ENABLED)
    if [ -z $1 ]; then
        if [ $IS_ENABLED -gt 0 ]; then
            touch $TOUCHPAD_SETTING
            IS_ENABLED=0
        else
            rm -f $TOUCHPAD_SETTING
            IS_ENABLED=1
        fi
        xinput set-prop $INPUT_ID "Device Enabled" $IS_ENABLED
    else
        echo $IS_ENABLED
    fi
}

function test-ssh()
{
    running=$(ssh -o BatchMode=yes -o ConnectTimeout=5 $1 echo $READY 2>&1)
    if [[ "$running" == "$READY" ]]; then
        echo $IS_CONNECTED
    else
        echo $NOT_CONNECTED
    fi
}
