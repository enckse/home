#!/bin/bash
BACKLIGHT_ON="up"
BACKLIGHT_OFF="down"
BRIGHTER="brighter"
FULL_BRIGHT="full"
LOW_BRIGHT="low"
MID_BRIGHT="mid"
DIMMER="dimmer"
CHANGE_BY_STEP=5
PROFILE_CYCLE="cycle"
MAIN_DISPLAY="eDP-1"
DISP_ONE="DP2-2"
DISP_TWO="DP2-1"
HOME_DISP="DP2-1"

function get-lighting-help()
{
    echo "
    $1 $2 $BACKLIGHT_ON (toggle backlights ON)
    $1 $2 $BACKLIGHT_OFF (toggle backlights OFF)
    $1 $3 $BRIGHTER (increase backlights)
    $1 $3 $DIMMER (decrease backlights)
    $1 $3 $FULL_BRIGHT (full brightness)
    $1 $4 $PROFILE_CYCLE (profile cycling)
    "
}

# Get displays, first argument can filter out any displays
function get-displays()
{
    get-all-displays " "
}

function get-all-displays()
{
    xrandr | grep "${1}connected" | cut -d " " -f 1
}

# Toggle backlighting up/down to a specified level
function toggle-backlighting()
{
    case $1 in
        $BACKLIGHT_ON | $FULL_BRIGHT | $BRIGHTER)
            SETTING=1.0
            ;;
        $BACKLIGHT_OFF | $LOW_BRIGHT | $DIMMER)
            SETTING=0.3
            ;;
        $MID_BRIGHT)
            SETTING=0.9
            ;;
        *)
            echo "Unknown command $1"
            ;;
    esac
    
    if [ ! -z "$SETTING" ]; then
        DISPLAYS=$(get-displays)
        for disp in ${DISPLAYS[@]}; do
            xrandr --output $disp --brightness $SETTING
        done
    fi
}

# Increase/decrease brightness
function change-brightness()
{
    toggle-backlighting $1
}
