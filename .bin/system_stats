#!/bin/bash
source $HOME/.bin/common
source $HOME/.bin/workspaces
STAT_SECONDARY="secondary"

function i3-stat()
{
    PRIMARY=0
    IS_SECOND=$PRIMARY
    if [ ! -z $1 ]; then
        case $1 in
        $STAT_SECONDARY)
            IS_SECOND=1
            ;;
        esac
    fi

    i3status | while :
    do
        read line
        ADDED_ICOS=""
        if [ $IS_SECOND -eq $PRIMARY ]; then
            WORK_ICO="|\xf0\x9f\x92\xbb"
            if [ -e $WORKPLACE_WORKING ]; then
                WORK_ICO=""
            fi
            DIM=$(xbacklight | awk '{printf "%3.0f", $1}')
            ADDED_ICOS="$WORK_ICO|$ADDED_ICOS$DIM"
            ADDED_ICOS="$ADDED_ICOS\xf0\x9f\x94\x86"
            TOUCH=$(toggle-touchpad "query")
            if [ $TOUCH -eq 0 ]; then
                ADDED_ICOS="$ADDED_ICOS\xf0\x9f\x8c\x82"
            fi
            if [ -e $DISPLAY_UN ]; then
                ADDED_ICOS="$ADDED_ICOS\xf0\x9f\x94\x93"
            fi
            if [ -e $DISPLAY_EN ]; then
                ADDED_ICOS="$ADDED_ICOS\xf0\x9f\x94\x92"
            fi
        fi
        echo -e "$line $ADDED_ICOS" || exit 1
    done
}
