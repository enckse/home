#!/bin/bash
tmp=$HOME/.cache/lgp/
mkdir -p $tmp
today=$tmp$(date +%Y-%m-%d)
if [ ! -e $today ]; then
    notify-send -t 5000 "pulling git changes"
    rm -f $tmp*
    valid=1
    sleep 5
    for f in $GIT_DIRS; do
        dname=$(dirname $f)
        remotes=$(git -C $dname remote | wc -l)
        if [ $remotes -gt 0 ]; then
            echo "pulling $dname"
            git -C $dname pull
            if [ $? -ne 0 ]; then
                valid=0
            fi
        fi
    done
    if [ $valid -eq 1 ]; then
        touch $today
    else
        notify-send -t 10000 "unable to pull git changes"
    fi
fi
