#!/usr/bin/perl
use strict;
use warnings;

my $cmd;
if (@ARGV) {
    $cmd = shift @ARGV;
}

die "no command" if !$cmd;

if ( $cmd eq "mail" ) {
    exit 0 if system("pgrep -x mbsync > /dev/null") == 0;
    my $mbsync = "/tmp/mbsync";
    if ( !-d $mbsync ) {
        mkdir $mbsync;
    }
    for ( ( "mbsync -a", "notmuch new" ) ) {
        system("$_ | systemd-cat -t 'mbsync'");
    }
}
elsif ( $cmd eq "autoclip" ) {
    system(
"source ~/store/personal/config/etc/private.exports && PASSWORD_STORE_DIR=/home/enck/.pass/personal pass -c \$AUTOCLIP > /dev/null"
    );
}
elsif ( $cmd eq "terminal" ) {
    system("kitty > /dev/null 2>&1");
}
else {
    print "unknown command";
}
