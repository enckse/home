pkgname=kxstitch-git
pkgver=2.2.0
pkgrel=1
pkgdesc="The program that lets you create cross stitch patterns and charts."
arch=('x86_64')
depends=('plasma-workspace' 'libmagick')
makedepends=('cmake' 'doxygen' 'extra-cmake-modules' 'kdoctools')
url="https://userbase.kde.org/KXStitch"
license=('GPL')
source=("https://github.com/KDE/kxstitch")
sha1sums=('SKIP')

build() {
    cd "$pkgname"
    rm -rf build
    mkdir build
    cd build
    cmake -DCMAKE_INSTALL_PREFIX=`qtpaths --install-prefix` .. \
          -DCMAKE_BUILD_TYPE="Release"
    make
}

pkgver() {
    cd "$pkgname"
    git describe --long | sed 's/\([^-]*-g\)/r\1/;s/-/./g'
}

package() {
    cd "$pkgname/build"
    make DESTDIR="${pkgdir}/usr" install
}
