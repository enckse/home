#!/bin/bash
_totp() {
    local opts cur
    opts=$(totp list)
    cur=${COMP_WORDS[COMP_CWORD]}
    COMPREPLY=( $(compgen -W "$opts" -- $cur) )
}


_wiki() {
    local cur opts
    cur=${COMP_WORDS[COMP_CWORD]}
    opts=$(find ~/store/personal/mirror/notebook -type f -name "*.md" | sed "s#/home/enck/store/personal/mirror/notebook/##g")
    COMPREPLY=( $(compgen -W "$opts" -- $cur) )
}

_backup() {
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    COMPREPLY=( $(compgen -W "status clear" -- $cur) )
}

_sys() {
    local cur opts
    cur=${COMP_WORDS[COMP_CWORD]}
    if [ $COMP_CWORD -eq 1 ]; then
        opts="history"
        if [ -z "$IS_DESKTOP" ]; then
            opts="$opts mail"
        fi
        COMPREPLY=( $(compgen -W "$opts" -- $cur) )
    fi
}

echo "$PATH" | grep -q "/home/enck"
if [ $? -eq 0 ]; then
    complete -F _sys sys
    complete -F _backup backup
    complete -F _totp totp
    complete -F _wiki wiki
fi
